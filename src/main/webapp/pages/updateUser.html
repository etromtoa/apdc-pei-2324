<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>So you want to give us more of your information that we
	can sell to the highest bidder? Thank you</title>
</head>

<body onload="setUpdateUserDefaults()">
	<h1>Oh, you want to change some information? Go ahead ^^</h1>
	<table>
		<tr>
			<td style="font-weight: bold;">Change your user info in our
				database:</td>

		</tr>
		<tr>
			<!--[START user_input]-->
			<td>
				<form action="/pages/updateUser.html" enctype="text/plain"
					method="post" name="updateUser" id="updateUser">
					<div>
						Username: <input type="text" name="username" id="username" /><br></br>
						Password: <input type="password" name="password" id="password" /><br></br>
						Confirmation Password: <input type="password" name="confirmation"
							id="confirmation" /><br></br> Email: <input type="text"
							name="email" id="email" /><br></br> Name: <input type="text"
							name="name" id="name" /><br></br> <input type="submit"
							onclick='updateUserHere(this)' value="Update User" />
					</div>
				</form>
			</td>
		</tr>
		<!--[END user_input]-->
	</table>
	<script>
		function setUpdateUserDefaults() {
			var url = location.search;
		}

		function updateUserHere() {
			event.preventDefault();
			var projectName = "my-first-project-415920";
			var reqUrl = "https://" + projectName
					+ ".oa.r.appspot.com/rest/register/update/";

			var username = document.getElementById('username').value;
			var password = document.getElementById('password').value;
			var confirmation = document.getElementById('confirmation').value;
			var email = document.getElementById('email').value;
			var name = document.getElementById('name').value;

			if (username == null || username == "" || password == null
					|| password == "" || confirmation == null
					|| confirmation == "" || email == null || email == ""
					|| name == null || name == "") {
				alert("All fields are required");
				return false;
			} else if (password != confirmation) {
				alert("Passwords don't match");
				return false;
			} else {
				var isThisWhatYouReallyWant = {
					"username" : username,
					"password" : password,
					"confirmation" : confirmation,
					"email" : email,
					"name" : name
				};

				var request = new XMLHttpRequest();
				request.open("PUT", reqUrl, true);
				request.setRequestHeader("Content-Type", "application/json");
				request.send(JSON.stringify(isThisWhatYouReallyWant));
				request.onreadystatechange = function() {
					if (request.readyState == 4) {
						if (request.status == 200) {
							alert(request.response);
						} else {
							alert("Error updating user. Please try again later.");
						}
					}
				};
			}
		}
	</script>
</body>

</html>